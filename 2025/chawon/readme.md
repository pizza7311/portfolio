## Chawon
자영업자를 대상으로 개인 브랜딩 및 웹사이트를 빠르고 간단하게 제작할 수 있는 SaaS형 웹 빌더 서비스의 **백엔드 설계 및 개발**을 담당했습니다.  
**진행 기간**: 2025.06 ~ 2025.09  
**프로젝트 상태**: 최종 무산  

---

## 기술 스택
**Backend**
- Nest.js, PostgreSQL, Prisma, Swagger  

**Cloud (AWS)**
- EC2, RDS, Lambda, VPC, CloudFront, SES, SQS, EventBridge  

**ETC**
- 구글/카카오 OAuth, NHN Cloud 알림톡  

---

## 핵심 담당 업무

### 기술 스택 및 아키텍처 설계
프로젝트 요구사항 분석 후, Supabase와 AWS + Nest.js로 백엔드 개발 중 직접 nest로 개발하는것이 더욱 적절하다고 판단되어 기술 스택을 확정하고 전체 백엔드 구조를 설계했습니다.  

---

### 클라우드 비용 최소화
- 테스트 서버(`test.chawon.com`)와 프로덕션 서버(`api.chawon.com`)를 분리.  
- 테스트 환경은 `EC2 (t2.micro)` 인스턴스에서 직접 구동.  
- 프로덕션은 **Serverless Framework + Lambda**로 배포하여 프리티어 한도 내에서 운영 비용 절감.  

---

### CloudFront CDN 구성
- 사용자가 업로드한 이미지를 `cdn.chawon.com` 도메인에서 관리.  
- **Lambda@Edge**를 통해 `w`, `h` 쿼리스트링으로 이미지 리사이징 및 **WebP 변환** 기능 구현.  

---

### 하드 딜리트 스케줄러
- 모든 테이블에 `deletedAt` 컬럼을 두고 **소프트 딜리트** 적용.  
- AWS **EventBridge + Lambda** 조합으로 주기적 하드 딜리트 수행.  
- 삭제된 데이터와 연결된 S3 파일도 함께 제거하여 **고아 파일 누적 방지**.  

---

### Swagger 문서 작성
 - 모든 API 엔드포인트에는 리퀘스트와 리스폰스 DTO를 작성
 - 프론트엔드 개발자가 타입을 한눈에 볼수있고 Swagger 문서에서 즉시 테스트 가능하도록 구현

---

## 주요 문제 해결 사례

### Lambda 코드 용량 제한 (250MB)
- Nest.js 프로젝트 빌드 시 Lambda 업로드 한도(250MB)를 초과.  
- 초기에는 캐시 제거·의존성 최소화 등으로 간신히 해결했으나 확장성 부족.  
- **`serverless-esbuild` 플러그인의 번들링 기능**을 적용하여  
  → 기존 300MB → **4~5MB 단일 JS 파일**로 압축, 문제 완전 해결.  

---

### VPC 내부 Lambda의 외부 접근 제한
- VPC 내부 Lambda에서 **Google/Kakao OAuth, 알림톡** 등 외부 API 통신 불가.  
- NAT 게이트웨이 비용이 과도하여, **외부 Lambda를 별도 배포** 후 내부 Lambda가 호출하도록 구조 변경.  
- 이 과정에서 **VPC 엔드포인트**를 활용해 보안성과 비용을 모두 고려한 통신 경로 구축.  

---

### JSON Schema 기반 데이터 유효성 검증
- 초기에는 각 리소스별 고정 테이블 구조였으나, 웹 빌더 특성상 **동적 블록 구조**로 변경.  
- 모든 페이지 요소를 `block` 테이블 하나에 JSON 형태로 통합 저장.  
- **JSON Schema**를 적용해 유효성 검증 자동화.  
- 프론트엔드 개발자가 직접 스키마를 등록하고 백엔드에서 해당 스키마 ID를 통해 검증하는 구조로  
  → **협업 효율성 및 확장성** 향상.  

---

### 비동기 알림 처리 (SQS + Lambda)
- 초기엔 API 요청 중 이메일·알림톡 발송을 동기 처리하여 트랜잭션 오류 발생.  
- 발송 기능을 **SQS + Lambda**로 분리하여 메인 API와 독립 운영.  
- SQS 재시도(최대 5회) 및 **DLQ(Dead Letter Queue)** 도입으로 안정성 확보.  

---

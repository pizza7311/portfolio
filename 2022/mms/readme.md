## MMS
XML 형태의 메뉴얼 파일을 번역 하기 위한 웹 기반 소프트웨어 입니다. 프론트엔드 와 서비스 백엔드 기능 개발을 담당하였습니다.  
xml 파일을 업로드하면 해당 파일의 텍스트를 추출하고 텍스트 목록을 db와 비교하여 서로 매칭되는(한글-영어) 문장이 있다면 영어로 변환후 번역된 xml 파일을 다운로드 하는것이 핵심 기능입니다.
  
개발 기간 : 2021/10 ~ 2022/06 기여도 : 90% (디자인과 css를 제외한 모든 개발 작업 진행)

## 기술 스택
### Front-end
* React
* SWR

### Back-end
* Koa.js
* MariaDB
* MongoDB

### Deploy (On-premise)
* Windows server
* nginx
* Synology NAS
* PM2

## 주요 기능
### 언어 변환 기능
![changePage](https://github.com/pizza7311/portfolio/blob/main/2022/mms/images/langChange.png)  
업로드한 xml의 텍스트 목록을 보여주고 수정할수 있는 페이지 입니다.  
* db에서 매칭된 텍스트가 있을경우 변환된 영문을 보여주며 없을경우 빈칸으로 표시  
* 수정된 목록은 노란색 배경으로 하이라이트
* xml에 삽입된 이미지 미리 보기 및 수정 기능

![changePage2](https://github.com/pizza7311/portfolio/blob/main/2022/mms/images/langChange2.png)  
각각의 텍스트를 클릭하여 직접 수정할수 있습니다.

### 언어 감수 기능
메뉴얼 원본 내용이 변경됨에 따라 (2023년 메뉴얼 -> 2024년 메뉴얼 업데이트)
기존의 텍스트 내용이 달라진 부분을 찾아서 수정하는 기능입니다.  
(예시: 2023년 메뉴얼의 '점화플러그' 라는 내용이 2024년 메뉴얼에선 '이그니션코일' 이라고 변경되었을때 2023년 메뉴얼에 있는 모든 '점화플러그' 라는 문장을 찾아서 변경해야할때)  
텍스트 변경 이력은 히스토리로 남겨 어떤 문장에서 어떤 문장으로 변경되었는지 기록을 확인할수 있습니다.


### DB관리 
![dbManage](https://github.com/pizza7311/portfolio/blob/main/2022/mms/images/dynamicURLQuery.gif)  
db에 등록된 텍스트를 관리하는 페이지 입니다. 검색,추가,수정,삭제 기능이 있으며 페이지네이션과 UX를 위해 쿼리스트링에 따라 동적으로 데이터를 받아오도록 구현하였습니다.  


## 프로젝트에 적용한 기술들

### Node.js 에서 멀티 스레드 사용
![multiThreads](https://github.com/pizza7311/portfolio/blob/main/2022/mms/images/multiThread.png)  
(멀티 스레드 구현 코드중 일부)  
프로젝트의 핵심인 매칭 기능은 xml에 포함된 텍스트와 db에 저장된 모든 데이터를 비교하는 `O(n*m)` 의 시간 복잡도를 가지고 개발 초기 단계에서 xml을 하나 번역하는데 평균 1~2분이 소요되었으며 큰 xml 파일은 3분 넘게 소요되기도 하였습니다.  
이 기능은 먼저 db에 있는 모든 데이터를 가져온다음 반복문으로 xml의 텍스트 배열과 하나씩 비교하는 로직입니다. 하지만 여기서 발생한 문제가 반복문의 경우 `CPU 집약 작업`으로 해당 반복문이 끝나기전 까진 다른 요청은 전부 멈춰버리는 문제가 발생하였습니다. 이는 Node.js가 싱글 스레드로 동작하기때문에 발생한 문제로 이를 해결하기위해 기존의 api 백엔드는 그대로 동작하고 데이터를 가지고 반복문을 돌리는 작업은 다른 스레드를 생성하여 처리하였습니다.  
이 기능을 구현할때 [node.js의 멀티 스레드를 소개하는 포스트](https://yceffort.kr/2021/04/nodejs-multithreading-worker-threads)를 참조하였습니다.

### NAS 서버와 연동
해당 프로젝트는 사내의 인트라넷에서만 사용하는 서비스로 기존에 사내에서 파일을 공유하는 NAS를 사용하고있었습니다.  
xml에 첨부된 이미지 파일은 기존 NAS에 전부 업로드된 상태이며 MMS에 별도의 파일 업로드 없이 NAS에 있는 파일을 그대로 사용하고싶다는 요구사항이 있어서 mms 서버와 nas 서버를 마운트 시켜 nas에 있는 파일에 바로 접근할수있도록 하였습니다.  
프론트엔드에 이미지를 서빙하는 기능은 mms에 마운트된 nas 이미지 폴더를 nginx를 통해 서빙 하도록 구현했습니다.

## 개선 사항
프로젝트가 완료된 후 유지보수를 진행하며 적용시킨 사항입니다.  

### 배포 자동화 구축
기존 mms가 업데이트 될때마다 직접 사내 로컬에 있는 서버에 접속하여 코드를 다운받고 빌드하고 적용시키는 방법을 사용했었습니다.  
하지만 해당 과정에 너무 많은 시간과 노력이 소모되어 자동으로 빌드하고 업데이트 하는 방법을 찾다가 `Docker`와 `Jenkins`를 이용하여 배포 자동화를 적용시키기로 했습니다.  
비록 처음 시도해본 배포 자동화라 완벽하지는 않았지만 클릭 한번으로 코드 클론 -> 빌드 -> 업로드 및 적용 까지 동작하는 자동화를 구축하였습니다.
